<script src="https://www.w3schools.com/lib/w3.js"></script>
<script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<style>
#myInput {
    background-color: transparent;
    background-image: linear-gradient(#1976d2, #1976d2), linear-gradient(#b1b8bb, #b1b8bb);
    background-position: center bottom, center calc(99%);
    background-repeat: no-repeat;
    background-size: 0 2px, 100% 1px;
    border: 0 none;
    border-radius: 0;
    box-shadow: none;
    float: none;
    margin-left: 8px;
    transition: background 0s ease-out 0s;
}

</style>
{% extends 'dashboard/adminDashboard.html' %}
{% load staticfiles %}
<script src="{% static 'js/jquery.js' %}" type="text/javascript"></script>
<script src="{% static 'js/jquery.ui.widget.js' %}" type="text/javascript"></script>
<script src="{% static 'js/jquery.iframe-transport.js' %}" type="text/javascript"></script>

{% block content %}

<div class="row page-titles">
    <div class="col-md-5 align-self-center">
        <h3 class="text-primary">Tasks</h3>
    </div>
</div>
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <form class="form-valide" method="post">{% csrf_token %}
                    <br>
                    <a data-toggle="modal" data-target="#addTask" id="add"  class="btn btn-primary active m-b-10 m-l-5 float-right">Add</a>
                    <table id="myTable" class="table table-bordered table-striped">
                        <thead>
                        <tr align="center">
                            <th>SLNo</th>
                            <th>TITLE</th>
                            <th>DESCRIPTION</th>
                            <th>DATE</th>
                            <th>STATUS</th>
                            <th>CREATED AT</th>
                            <th>IS DELETED</th>
                            <th>ACTION</th>
                        </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </form>

            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="addTask" role="dialog">
    <form id="addform" class="form-valide" method="post" action="/addTaskLogic/">{% csrf_token %}
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 align="center" class="modal-title">Add Task</h4>
                </div>
                <div class="modal-body" id="cancelReasonModelDiv">

                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary active">Add</button>
                    <button type="button" class="btn btn-primary active" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </form>
</div>
<script>

$(document).ready(function(){

        $('#add').click(function(){
              $('#addform')[0].reset();
            console.log("something");
        });


        $.ajax({
              cache: false,
              url: url_site+'listBizButtonsAPI/',
              type: 'get',
              dataType: 'json',
              headers: {},
              success: function(data, textStatus, xhr)
                {
                    table = $('#myTable').DataTable();

                    var width="10%"
                    let currRow = ''
                    let rowData = ''
                    currentLangData = data['result']
                    currentLangDataupdate = data['result']
                    for(var i=0;i<data['result'].length;i++)
                    {
                        currRow = data['result'][i]['id']
                        rowData=data['result'][i]['text']
                        console.log(rowData)
                        table.row.add(['<div style="text-align: center;">' + (i + 1) + '</div>',
                        '<div style="text-align: center;"><a data-toggle="modal" class="supportTextmodel1" data-value='+ i +' data-name='+JSON.stringify(rowData)+' data-target="#supportModel">' + data['result'][i]['text']['en'] + '</a></div>',
                        '&nbsp;&nbsp;<a class="delRow" id='+currRow+' onclick=DeleteBtn("' + currRow.toString() + '") style="color:red"><i class="fa fa-trash" style="font-size:20px;"></i></a></div>']);
                    }
                    table.draw();
                },
        });
});


function DeleteBtn(id)
    {
    console.log('hello');
    console.log(id);
    console.log(id.split('/'));
        swal({
                title: "Are you sure you want to delete it ?",
                text: "You will not be able to recover this file !!",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "Yes, disable it !!",
                cancelButtonText: "No, cancel it !!",
                closeOnConfirm: false,
                closeOnCancel: false
            },
            function(isConfirm)
            {
                if (isConfirm) {
                    $.ajax({
                         url: url_site+'bizButtonsAPIUpdateAPI/',
                         type: 'get',
                         dataType: '',
                         contentType: 'application/json',
                         headers: {"bizbuttonId":id.split('/'), "deleteStatus": 2},
                         data:"",
                         success: function (data, textStatus, xhr) {
                             location.reload()
                            },
                         error: function (xhr, textStatus, errorThrown) {
                             console.log('Error in Operation');
                         }
                     });
                }

                else {
                    swal("Cancelled !!", "Hey, your imaginary file is safe !!", "error");
                }

            });

};

</script>
<script src="{% static 'js/lib/toastr/toastr.min.js' %}"></script>
<script src="{% static 'js/lib/toastr/toastr.init.js' %}"></script>
{% endblock %}